FUNCTION grad(f_in, x)
!########################################################################
IMPLICIT NONE
!########################################################################
REAL(kind=REAL64), EXTERNAL ::              f_in
REAL(kind=REAL64), INTENT(IN) ::            x
REAL(kind=REAL64) ::                        grad
!########################################################################
REAL(kind=REAL64) ::                        h
!########################################################################
h = 1.0D-5
grad = (f_in(x+h) - f_in(x-h)) / (2 * h)
END FUNCTION grad